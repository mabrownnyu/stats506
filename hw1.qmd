---
title: "Homework 1"
format: html
editor: visual
author: "Megan Brown"
---

# Problem 1 - Abalone Data

## Problem 1(a)

```{r}

# column names from abalone.names
columns <- c("sex", "length", "diameter", "height", "whole_weight",
             "shucked_weight", "viscera_weight", "shell_weight", "rings")

# data from abalone.data
df <- read.csv('datasets/abalone/abalone.data', header=FALSE)

# set new column names
names(df) <- columns
```

## Problem 1(b)

```{r}

# count the number of records by sex 
table(df$sex)
```

There are 1,307 females, 1,342 infants, and 1,528 males.

## Problem 1(c)

### Problem 1(c)(1)

I found the R function for correlation from [this blog post](https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/).

```{r}

# correlation between different weights and rings
print(paste0("Whole Weight: ", cor(df$whole_weight, df$rings)))

print(paste0("Shucked Weight: ", cor(df$shucked_weight, df$rings)))

print(paste0("Viscera Weight: ", cor(df$viscera_weight, df$rings)))

print(paste0("Shell Weight: ", cor(df$shell_weight, df$rings)))

```

Shell weight is most correlated with rings.

### Problem 1(c)(2)

```{r}
# split dataframes by sex
males <- df[df$sex == "M",]
females <- df[df$sex == "F",]
infants <- df[df$sex == "I",]

# output correlations
print(paste0("Males: ", cor(males$shell_weight, males$rings)))
print(paste0("Females: ", cor(females$shell_weight, females$rings)))
print(paste0("Infants: ", cor(infants$shell_weight, infants$rings)))

```

For infants, shell weight was most correlated with rings.

### Problem 1(c)(3)

```{r}
# get the record where the number of rings is the highest number of rings
df[df$rings == max(df$rings),]
```

For the abalone with the most rings, the whole weight was 1.8075g, the shucked weight was 0.7055g, the viscera weight was 0.3215g, and the shell weight was 0.475g.

### Problem 1(c)(4)

```{r}
numerator <- nrow(df[df$viscera_weight > df$shell_weight,]) 
denominator <- nrow(df)

print(100*numerator/denominator)
```

The percentage of abalones for which the viscera weight was greater than the shell weight was 6.51%.

## Problem 1(d)

```{r}


male_correlations <- cor(males[,c("whole_weight", "shucked_weight",
                                  "viscera_weight", "shell_weight")], males$rings)
female_correlations <- cor(females[,c("whole_weight", "shucked_weight", 
                                      "viscera_weight", "shell_weight")], females$rings)
infant_correlations <- cor(infants[,c("whole_weight", "shucked_weight", 
                                      "viscera_weight", "shell_weight")], infants$rings)

correlations <- data.frame(cbind(male_correlations, female_correlations,
                                 infant_correlations))
names(correlations) <- c("M (rings)", "F (rings)", "I (rings)")

correlations
```

## Problem 1(e)

First, testing the difference between males and females.

```{r}
t.test(males$rings, females$rings)
```

Then, testing the difference between males and infants.

```{r}
t.test(males$rings, infants$rings)
```

Lastly, testing the difference between females and infants.

```{r}
t.test(females$rings, infants$rings)
```

Each group has a statistically significant difference in the number of rings among the group. Particularly, infants had an average of 8 rings, and males and females had an average of 10.7 and 11.1 rings, respectively. While the magnitude of the difference between the number of rings between males and females is smaller, the different is statistically significant.

# Problem 2 - Food Expenditure Data
